<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PL-300 Master Class</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Use Inter font -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');

        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            color: #1f2937;
        }

        /* Custom scrollbar for better appearance */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-thumb {
            background-color: #d1d5db;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-track {
            background: #f3f4f6;
        }

        /* Utility classes for modern look */
        .card {
            background-color: white;
            border-radius: 1rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .card:hover {
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        .gradient-bg {
            background: linear-gradient(135deg, #f59e0b, #f97316);
        }

        .input-focus:focus {
            --tw-ring-opacity: 1;
            box-shadow: 0 0 0 3px rgba(245, 158, 11, var(--tw-ring-opacity));
            border-color: #f59e0b;
        }

        .loader {
            border-top-color: #f59e0b;
            -webkit-animation: spin 1s linear infinite;
            animation: spin 1s linear infinite;
        }

        @-webkit-keyframes spin {
            0% {
                -webkit-transform: rotate(0deg);
            }

            100% {
                -webkit-transform: rotate(360deg);
            }
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }
    </style>
    <!-- Firebase Imports (ES Modules) -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, getDoc, onSnapshot, collection, query, orderBy, limit, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Set Firebase log level for debugging
        setLogLevel('debug');

        // --- GLOBAL VARIABLES & INITIALIZATION ---

        // These variables are provided by the canvas environment
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        // Note: firebaseConfig might be populated by the environment or be an empty object.
        const firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

        let db = null;
        let auth = null;
        let userId = null;
        let userName = '';
        let appInitialized = false;

        // Determine initial mode based on the environment configuration presence
        let isReadWriteMode = firebaseConfig && firebaseConfig.projectId;

        const STATE = {
            isAuthReady: false,
            // User-specific settings collection path
            get userDocPath() {
                // Ensure userId is not null before constructing path, though auth should handle this
                const currentUserId = userId || 'anonymous'; 
                return `/artifacts/${appId}/users/${currentUserId}/config/profile`;
            },
        };

        // --- UI ELEMENTS ---

        const readOnlyBanner = document.getElementById('read-only-banner');
        const mainContent = document.getElementById('main-content');
        const authModal = document.getElementById('auth-modal');
        const userNameInput = document.getElementById('user-name-input');
        const saveNameButton = document.getElementById('save-name-button');
        const profileDisplay = document.getElementById('profile-display');
        const quizCountDisplay = document.getElementById('quiz-count');
        const loadingIndicator = document.getElementById('loading-indicator');
        const historyButton = document.getElementById('history-button');
        const modalContainer = document.getElementById('modal-container');
        const historyList = document.getElementById('history-list');

        // --- CORE APPLICATION LOGIC ---

        async function initFirebase() {
            if (appInitialized) return;
            appInitialized = true;

            // 1. Initialization Attempt (using environment/canvas config)
            if (isReadWriteMode) {
                try {
                    const app = initializeApp(firebaseConfig);
                    db = getFirestore(app);
                    auth = getAuth(app);
                    console.log("Firebase initialized successfully using environment config.");
                } catch (error) {
                    console.error("Failed to initialize Firebase with environment config. Switching to Read-Only mode:", error);
                    isReadWriteMode = false;
                }
            }

            // 2. Check and exit if in Read-Only Mode
            if (!isReadWriteMode) {
                console.error("Firebase configuration missing or invalid. Running in Read-Only mode.");
                readOnlyBanner.classList.remove('hidden');
                loadingIndicator.classList.add('hidden');
                return;
            }

            // 3. Authentication Attempt
            try {
                // Sign in using the custom token provided by the environment, or anonymously as fallback
                if (initialAuthToken) {
                    await signInWithCustomToken(auth, initialAuthToken);
                } else {
                    await signInAnonymously(auth);
                }

                // 4. Set up Auth State Listener
                onAuthStateChanged(auth, (user) => {
                    if (user) {
                        userId = user.uid;
                        STATE.isAuthReady = true;
                        console.log(`User authenticated: ${userId}. Initializing database listeners.`);
                        // Fetch user profile and start listening for data
                        loadUserProfile();
                        listenForQuizHistory();
                    } else {
                        userId = null;
                        STATE.isAuthReady = true; // Still mark as ready, even if logged out
                        console.log("No user is signed in. Using anonymous ID.");
                        // Handle anonymous user fallback if necessary
                    }
                });

            } catch (error) {
                // This catch block handles the specific 'api-key-not-valid' error
                console.error("Error during Firebase authentication:", error);

                // Fall back to Read-Only mode gracefully.
                isReadWriteMode = false;
                readOnlyBanner.classList.remove('hidden');
                readOnlyBanner.textContent = `Authentication failed. Reverting to Read-Only mode. (Code: ${error.code})`;
                loadingIndicator.classList.add('hidden');

                // If authentication fails, we must also ensure the main content is visible 
                // and the interactive elements are disabled, although the initial check 
                // in window.onload should handle this.
            }
        }

        // --- USER PROFILE HANDLING ---

        async function loadUserProfile() {
            if (!userId || !db) return;

            loadingIndicator.classList.remove('hidden');

            try {
                const docRef = doc(db, STATE.userDocPath);
                const docSnap = await getDoc(docRef);

                if (docSnap.exists()) {
                    const data = docSnap.data();
                    userName = data.name || `User ${userId.substring(0, 8)}`;
                } else {
                    console.log("No existing profile found. Prompting for name.");
                    // Show modal to set name if none exists
                    showAuthModal();
                    loadingIndicator.classList.add('hidden');
                    return;
                }

                updateUIForAuthenticatedUser();
            } catch (error) {
                console.error("Error loading user profile:", error);
                // Fallback to anonymous name
                userName = `User ${userId.substring(0, 8)}`;
                updateUIForAuthenticatedUser();
            } finally {
                loadingIndicator.classList.add('hidden');
            }
        }

        function showAuthModal() {
            authModal.classList.remove('hidden');
            mainContent.classList.add('hidden');
        }

        function hideAuthModal() {
            authModal.classList.add('hidden');
            mainContent.classList.remove('hidden');
        }

        async function saveUserName() {
            const newName = userNameInput.value.trim();
            if (!newName) {
                // Use a simple custom message instead of alert
                alertMessage("Please enter a valid name.", 'error');
                return;
            }

            // Check if read/write mode is active before saving
            if (!isReadWriteMode || !db) {
                alertMessage("Cannot save name. App is in Read-Only Mode.", 'error');
                return;
            }

            userName = newName;
            saveNameButton.disabled = true;
            saveNameButton.textContent = 'Saving...';

            try {
                const docRef = doc(db, STATE.userDocPath);
                // Use setDoc to create or overwrite the profile
                await setDoc(docRef, {
                    name: userName,
                    userId: userId,
                    createdAt: serverTimestamp()
                }, { merge: true });

                hideAuthModal();
                updateUIForAuthenticatedUser();
            } catch (error) {
                console.error("Error saving user profile:", error);
                alertMessage("Failed to save name. Please try again.", 'error');
            } finally {
                saveNameButton.disabled = false;
                saveNameButton.textContent = 'Save Name';
            }
        }

        function updateUIForAuthenticatedUser() {
            profileDisplay.textContent = `Logged in as: ${userName} (ID: ${userId})`;
            hideAuthModal();
        }

        // --- QUIZ HISTORY HANDLING ---

        function getQuizHistoryPath() {
            // Ensure path is generated using the authenticated userId for security rules
            const currentUserId = auth.currentUser?.uid || userId;
            return `/artifacts/${appId}/users/${currentUserId}/quizzes`;
        }

        function listenForQuizHistory() {
            if (!userId || !db) return;

            const q = collection(db, getQuizHistoryPath());

            // Using onSnapshot for real-time updates
            onSnapshot(q, (snapshot) => {
                const count = snapshot.size;
                quizCountDisplay.textContent = `${count}`;
                console.log(`Total quiz attempts: ${count}`);

                // Store history data for the modal
                const historyData = [];
                snapshot.forEach(doc => {
                    const data = doc.data();
                    historyData.push({ id: doc.id, ...data });
                });
                renderHistoryModal(historyData);

            }, (error) => {
                console.error("Error listening to quiz history:", error);
                // Check if the error is a permission issue due to Read-Only mode
                if (error.code === 'permission-denied') {
                     alertMessage("Cannot access quiz history. Ensure you have the correct permissions.", 'error');
                } else {
                     alertMessage("Failed to load quiz history.", 'error');
                }
            });
        }

        // --- MOCK QUIZ FUNCTIONALITY ---
        // This is a mock function to simulate a quiz completion and save data

        function getMockQuizData(topic) {
            const totalQuestions = 10;
            const correct = Math.floor(Math.random() * (totalQuestions + 1));
            const percentage = Math.round((correct / totalQuestions) * 100);
            const passed = percentage >= 70; // Mock pass threshold

            return {
                topic: topic,
                totalQuestions: totalQuestions,
                correctAnswers: correct,
                percentage: percentage,
                passed: passed,
                timestamp: new Date().toISOString(), // Store timestamp as a string/ISO for display
                serverTimestamp: serverTimestamp() // Firestore timestamp for server-side accuracy
            };
        }

        async function recordMockQuiz(topic) {
            if (!isReadWriteMode || !userId || !db) {
                alertMessage("Cannot record quiz. App is in Read-Only Mode.", 'error');
                return;
            }

            loadingIndicator.classList.remove('hidden');

            const quizData = getMockQuizData(topic);
            const collectionRef = collection(db, getQuizHistoryPath());

            try {
                // Add a new document to the quizzes subcollection
                // Doc ref generation is automatically handled by the SDK when calling setDoc without a specific ID
                await setDoc(doc(collectionRef), quizData); 
                console.log(`Quiz recorded for topic: ${topic}`);

                alertMessage(`Quiz on '${topic}' recorded! Score: ${quizData.percentage}%.`, quizData.passed ? 'success' : 'warning');
            } catch (error) {
                console.error("Error recording quiz:", error);
                alertMessage("Failed to record quiz history.", 'error');
            } finally {
                loadingIndicator.classList.add('hidden');
            }
        }

        // --- MODAL & MESSAGE BOX UTILITIES ---

        function alertMessage(message, type = 'info') {
            const colors = {
                'info': 'bg-blue-100 text-blue-800 border-blue-500',
                'success': 'bg-green-100 text-green-800 border-green-500',
                'error': 'bg-red-100 text-red-800 border-red-500',
                'warning': 'bg-yellow-100 text-yellow-800 border-yellow-500'
            };

            const div = document.createElement('div');
            div.className = `fixed top-4 right-4 z-50 p-4 border-l-4 rounded-lg shadow-lg max-w-sm ${colors[type]} transition-opacity duration-300`;
            div.textContent = message;

            document.body.appendChild(div);

            // Auto-remove after 4 seconds
            setTimeout(() => {
                div.style.opacity = '0';
                setTimeout(() => div.remove(), 300);
            }, 4000);
        }

        function renderHistoryModal(history) {
            historyList.innerHTML = '';
            // Sort history by server timestamp (newest first)
            history.sort((a, b) => {
                // Handle cases where serverTimestamp might be missing or not a Firestore Timestamp object
                const timeA = a.serverTimestamp?.seconds ? a.serverTimestamp.seconds * 1000 : new Date(a.timestamp).getTime();
                const timeB = b.serverTimestamp?.seconds ? b.serverTimestamp.seconds * 1000 : new Date(b.timestamp).getTime();
                return timeB - timeA;
            });


            if (history.length === 0) {
                historyList.innerHTML = `<p class="text-gray-500 p-4">No quiz attempts recorded yet. Take a practice quiz!</p>`;
                return;
            }

            history.forEach((quiz) => {
                const date = new Date(quiz.timestamp).toLocaleString();
                const passedClass = quiz.passed ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700';

                const li = document.createElement('li');
                li.className = `p-4 border-b last:border-b-0 flex justify-between items-center ${passedClass}`;
                li.innerHTML = `
                    <div class="flex flex-col">
                        <span class="font-semibold">${quiz.topic}</span>
                        <span class="text-sm text-gray-600">${date}</span>
                    </div>
                    <div class="text-lg font-bold">
                        ${quiz.percentage}%
                    </div>
                `;
                historyList.appendChild(li);
            });
        }

        function showHistoryModal() {
            modalContainer.classList.remove('hidden');
        }

        function hideHistoryModal() {
            modalContainer.classList.add('hidden');
        }


        // --- EVENT LISTENERS ---

        window.onload = function () {
            initFirebase();
            // We attach listeners regardless of mode, but the functions check isReadWriteMode internally.
            saveNameButton.addEventListener('click', saveUserName);
            historyButton.addEventListener('click', showHistoryModal);
            document.getElementById('close-modal').addEventListener('click', hideHistoryModal);
            document.getElementById('modal-container').addEventListener('click', (e) => {
                if (e.target.id === 'modal-container') {
                    hideHistoryModal();
                }
            });

            // Attach mock quiz handlers
            document.querySelectorAll('.quiz-item').forEach(item => {
                item.addEventListener('click', (e) => {
                    const topic = e.currentTarget.getAttribute('data-topic');
                    recordMockQuiz(topic);
                });
            });
            
            // Initial check for read-only status in case initFirebase is synchronous or fails fast
            if (!isReadWriteMode) {
                readOnlyBanner.classList.remove('hidden');
                loadingIndicator.classList.add('hidden');
            }
        };

    </script>
</head>

<body>
    <!-- Full-screen Container -->
    <div class="min-h-screen flex flex-col items-center">

        <!-- Top Banner (Always Visible) -->
        <div class="w-full gradient-bg text-white p-4 shadow-lg flex items-center justify-between">
            <h1 class="text-xl font-bold tracking-tight">PL-300 Master Class</h1>
            <!-- Read-Only Banner (Hidden by default) -->
            <div id="read-only-banner" class="hidden text-sm font-semibold bg-yellow-600 text-yellow-100 py-1 px-3 rounded-full shadow-md">
                Read-Only Mode
            </div>
            <div class="flex items-center space-x-2">
                <span id="profile-display" class="text-sm font-medium">Loading...</span>
            </div>
        </div>

        <!-- Main Content Area -->
        <div id="main-content" class="w-full max-w-3xl p-6 space-y-8 flex-grow">
            <!-- Loading Indicator -->
            <div id="loading-indicator" class="flex justify-center items-center h-40">
                <div class="loader ease-linear rounded-full border-4 border-t-4 border-gray-200 h-12 w-12"></div>
            </div>

            <!-- Exam Dashboard Card -->
            <div class="card p-6 w-full shadow-2xl">
                <div class="flex items-center justify-between border-b pb-4 mb-4">
                    <h2 class="text-2xl font-semibold text-gray-800">Exam Dashboard</h2>
                    <div class="flex items-center space-x-4">
                        <div class="flex items-center space-x-1 text-gray-600">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-yellow-500" viewBox="0 0 20 20"
                                fill="currentColor">
                                <path fill-rule="evenodd"
                                    d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.414-1.414L11 9.586V6z"
                                    clip-rule="evenodd" />
                            </svg>
                            <span class="text-sm">Attempts Recorded:</span>
                            <span id="quiz-count" class="font-bold">0</span>
                        </div>
                        <button id="history-button"
                            class="bg-yellow-500 hover:bg-yellow-600 text-white font-medium py-2 px-4 rounded-full shadow-lg transition duration-200 focus:outline-none focus:ring-4 focus:ring-yellow-300">
                            History
                        </button>
                    </div>
                </div>

                <!-- Section 1 -->
                <div class="quiz-item flex justify-between items-center p-4 transition duration-150 ease-in-out hover:bg-gray-50 cursor-pointer rounded-lg border-b border-gray-100 last:border-b-0"
                    data-topic="Prepare the Data">
                    <div class="flex items-center space-x-4">
                        <div class="p-3 bg-yellow-100 rounded-lg text-yellow-600">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 20 20"
                                fill="currentColor">
                                <path fill-rule="evenodd"
                                    d="M11.49 3.17c-.38-.21-.74-.02-.74.43v14.16c0 .45.36.63.74.43l5.05-3.32c.38-.25.38-.66 0-.91l-5.05-3.32zM3.49 4.31c-.38-.21-.74-.02-.74.43v14.16c0 .45.36.63.74.43l5.05-3.32c.38-.25.38-.66 0-.91l-5.05-3.32z"
                                    clip-rule="evenodd" />
                            </svg>
                        </div>
                        <div>
                            <p class="text-lg font-semibold text-gray-800">1. Prepare the Data (25-30%)</p>
                            <p class="text-sm text-gray-500">Get Data, Clean, Transform, and Load.</p>
                        </div>
                    </div>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400" viewBox="0 0 20 20"
                        fill="currentColor">
                        <path fill-rule="evenodd"
                            d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"
                            clip-rule="evenodd" />
                    </svg>
                </div>

                <!-- Section 2 -->
                <div class="quiz-item flex justify-between items-center p-4 transition duration-150 ease-in-out hover:bg-gray-50 cursor-pointer rounded-lg border-b border-gray-100 last:border-b-0"
                    data-topic="Model the Data">
                    <div class="flex items-center space-x-4">
                        <div class="p-3 bg-blue-100 rounded-lg text-blue-600">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 20 20"
                                fill="currentColor">
                                <path
                                    d="M3 10a2 2 0 012-2h10a2 2 0 012 2v3a2 2 0 01-2 2H5a2 2 0 01-2-2v-3zM5 13a1 1 0 100-2 1 1 0 000 2zm4 0a1 1 0 100-2 1 1 0 000 2zm4 0a1 1 0 100-2 1 1 0 000 2zm4 0a1 1 0 100-2 1 1 0 000 2z" />
                                <path
                                    d="M3 10a2 2 0 012-2h10a2 2 0 012 2v3a2 2 0 01-2 2H5a2 2 0 01-2-2v-3zM5 13a1 1 0 100-2 1 1 0 000 2zm4 0a1 1 0 100-2 1 1 0 000 2zm4 0a1 1 0 100-2 1 1 0 000 2zm4 0a1 1 0 100-2 1 1 0 000 2zM5 6h10a2 2 0 012 2v1h-14V8a2 2 0 012-2z" />
                            </svg>
                        </div>
                        <div>
                            <p class="text-lg font-semibold text-gray-800">2. Model the Data (25-30%)</p>
                            <p class="text-sm text-gray-500">Schema Design, Relationships, and DAX.</p>
                        </div>
                    </div>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400" viewBox="0 0 20 20"
                        fill="currentColor">
                        <path fill-rule="evenodd"
                            d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"
                            clip-rule="evenodd" />
                    </svg>
                </div>

                <!-- Section 3 -->
                <div class="quiz-item flex justify-between items-center p-4 transition duration-150 ease-in-out hover:bg-gray-50 cursor-pointer rounded-lg border-b border-gray-100 last:border-b-0"
                    data-topic="Visualize & Analyze">
                    <div class="flex items-center space-x-4">
                        <div class="p-3 bg-green-100 rounded-lg text-green-600">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 20 20"
                                fill="currentColor">
                                <path
                                    d="M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z" />
                            </svg>
                        </div>
                        <div>
                            <p class="text-lg font-semibold text-gray-800">3. Visualize & Analyze (25-30%)</p>
                            <p class="text-sm text-gray-500">Charts, UX, Accessibility, and AI.</p>
                        </div>
                    </div>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400" viewBox="0 0 20 20"
                        fill="currentColor">
                        <path fill-rule="evenodd"
                            d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"
                            clip-rule="evenodd" />
                    </svg>
                </div>

                <!-- Section 4 -->
                <div class="quiz-item flex justify-between items-center p-4 transition duration-150 ease-in-out hover:bg-gray-50 cursor-pointer rounded-lg border-b border-gray-100 last:border-b-0"
                    data-topic="Deploy & Maintain">
                    <div class="flex items-center space-x-4">
                        <div class="p-3 bg-purple-100 rounded-lg text-purple-600">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 20 20"
                                fill="currentColor">
                                <path
                                    d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14a2 2 0 01-2 2H7a2 2 0 01-2-2V4zm2 14h6V4H7v14zm-1-7h10a1 1 0 000-2H6a1 1 0 000 2z" />
                            </svg>
                        </div>
                        <div>
                            <p class="text-lg font-semibold text-gray-800">4. Deploy & Maintain (15-20%)</p>
                            <p class="text-sm text-gray-500">Publish, Security, and Governance.</p>
                        </div>
                    </div>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400" viewBox="0 0 20 20"
                        fill="currentColor">
                        <path fill-rule="evenodd"
                            d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"
                            clip-rule="evenodd" />
                    </svg>
                </div>
            </div>

            <p class="text-center text-sm text-gray-500">Click any section to start a mock quiz and record your attempt!</p>
        </div>

    </div>

    <!-- User Name Modal (Hidden by default) -->
    <div id="auth-modal"
        class="hidden fixed inset-0 bg-gray-900 bg-opacity-75 z-50 flex items-center justify-center p-4">
        <div class="bg-white card p-6 w-full max-w-sm">
            <h3 class="text-xl font-semibold mb-4 text-gray-800">Welcome!</h3>
            <p class="text-sm text-gray-600 mb-4">Please set your name to enable saving quiz history to the database.</p>
            <input type="text" id="user-name-input"
                class="w-full px-4 py-2 border border-gray-300 rounded-lg input-focus focus:ring-2 focus:ring-opacity-50"
                placeholder="Enter your name">
            <button id="save-name-button"
                class="mt-4 w-full gradient-bg text-white font-semibold py-2 rounded-lg hover:shadow-xl transition duration-200">
                Save Name
            </button>
        </div>
    </div>

    <!-- History Modal (Hidden by default) -->
    <div id="modal-container"
        class="hidden fixed inset-0 bg-gray-900 bg-opacity-75 z-50 flex items-center justify-center p-4">
        <div class="bg-white card w-full max-w-md max-h-[80vh] flex flex-col">
            <div class="p-6 border-b flex justify-between items-center">
                <h3 class="text-xl font-semibold text-gray-800">Quiz History</h3>
                <button id="close-modal" class="text-gray-400 hover:text-gray-600 transition">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <ul id="history-list" class="overflow-y-auto divide-y divide-gray-100 flex-grow">
                <!-- History items will be rendered here -->
            </ul>
            <div class="p-4 text-xs text-center text-gray-500 border-t">
                Scores over 70% are considered passing.
            </div>
        </div>
    </div>
</body>

</html>
